/*! 
 Build based on admin-vue 
 Time : 1721439181000 */
import{a8 as e,o as l,c as a,x as t,h as o,w as s,d as r,e as u,b as i,cM as n,g as c,cW as m,S as d,d7 as p,a as v,cS as f,F as g,Z as y,$ as h,d8 as C,t as w,ar as B,j as k,l as x,E as b}from"./087AC4D233B64EB0index.3a42c3d0.js";import{E as j}from"./087AC4D233B64EB0drawer.53419836.js";import"./087AC4D233B64EB0overlay.b3cb4214.js";import{E}from"./087AC4D233B64EB0pagination.0e771729.js";/* empty css                              *//* empty css                            */import"./087AC4D233B64EB0select.e68fc9c3.js";import"./087AC4D233B64EB0scrollbar.f28f83ad.js";/* empty css                               */import{E as D}from"./087AC4D233B64EB0image-viewer.20dbe01e.js";/* empty css                               */import{i as _,a as A,_ as I,U as z,e as V,g as S,d as T}from"./087AC4D233B64EB0common.41b28400.js";import{W as U}from"./087AC4D233B64EB0warningBar.7ffbb10e.js";const M={class:"w-40 h-40 relative rounded border border-dashed border-gray-300 overflow-hidden cursor-pointer group"},P={key:1,class:"w-full h-full object-cover",muted:"",preload:"metadata"},F=["src"],O=["src"],W={__name:"selectComponent",props:{model:{default:"",type:String}},emits:["chooseItem","deleteItem"],setup(p,{emit:v}){const f=v,g=()=>{f("chooseItem")},y=()=>{f("deleteItem")};return(v,f)=>{const h=e("VideoPlay"),C=d;return l(),a("div",M,[t(_)(p.model||"")?(l(),o(C,{key:0,size:32,class:"absolute top-[calc(50%-16px)] left-[calc(50%-16px)]"},{default:s((()=>[r(h)])),_:1})):u("",!0),t(_)(p.model||"")?(l(),a("video",P,[i("source",{src:t(A)(p.model)+"#t=1"},null,8,F)])):u("",!0),p.model&&!t(_)(p.model)?(l(),a("img",{key:2,class:"w-full h-full",src:t(A)(p.model),alt:"图片"},null,8,O)):u("",!0),p.model?(l(),a("div",{key:3,class:"left-0 top-0 hidden text-gray-600 group-hover:bg-gray-600 group-hover:bg-opacity-30 w-full h-full group-hover:flex justify-center items-center absolute z-10",onClick:y},[r(C,null,{default:s((()=>[r(t(n))])),_:1}),c(" 删除 ")])):(l(),a("div",{key:4,class:"text-gray-600 group-hover:bg-gray-400 w-full h-full flex justify-center items-center",onClick:g},[r(C,null,{default:s((()=>[r(t(m))])),_:1}),c(" 上传 ")]))])}}},G={key:1,class:"w-full gap-4 flex"},H={class:"gva-btn-list gap-2"},K={class:"flex flex-wrap gap-4"},N={class:"w-40 h-40 border rounded overflow-hidden border-dashed border-gray-300 cursor-pointer relative group"},Z=["onClick"],$=["src"],q={key:2,class:"w-full h-full object-cover flex items-center justify-center"},J=["onClick"],L=["onClick"],Q={__name:"selectImage",props:p({multiple:{type:Boolean,default:!1},fileType:{type:String,default:""},maxUpdateCount:{type:Number,default:0}},{modelValue:{type:[String,Array]},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const m=v(""),p=v(""),M=v({}),P=v(1),F=v(0),O=v(20),Q=f(n,"modelValue"),R=n,X=v([]);g((()=>{R.multiple&&(X.value=Q.value)}));const Y=e=>{O.value=e,re()},ee=e=>{P.value=e,re()},le=v(!1),ae=v([]),te={image:["png","jpg","jpeg","gif","bmp","webp"],video:["mp4","avi","rmvb","rm","asf","divx","mpg","mpeg","mpe","wmv","mkv","vob"]},oe=e=>{if(R.fileType){if(!te[R.fileType].some((l=>{if(e.includes(l))return!0})))return void k({type:"error",message:"当前类型不支持使用"})}R.multiple?(X.value.push(e),Q.value=X.value):Q.value=e,le.value=!1},se=async()=>{!Q.value||R.multiple?(await re(),le.value=!0):Q.value=""},re=async()=>{const e=await S({page:P.value,pageSize:O.value,...M.value});0===e.code&&(ae.value=e.data.list,F.value=e.data.total,P.value=e.data.page,O.value=e.data.pageSize)};return(v,f)=>{const g=x,S=b,te=e("VideoPlay"),ue=d,ie=D,ne=e("CircleClose"),ce=E,me=j;return l(),a("div",null,[n.multiple?(l(),a("div",G,[(l(!0),a(y,null,h(X.value,((e,a)=>(l(),o(W,{key:a,model:e,onChooseItem:se,onDeleteItem:e=>(e=>{X.value.splice(e,1),Q.value=X.value})(a)},null,8,["model","onDeleteItem"])))),128)),X.value.length<R.maxUpdateCount||0===R.maxUpdateCount?(l(),o(W,{key:0,onChooseItem:se,onDeleteItem:se})):u("",!0)])):(l(),o(W,{key:0,model:Q.value,onChooseItem:se,onDeleteItem:se},null,8,["model"])),r(me,{modelValue:le.value,"onUpdate:modelValue":f[1]||(f[1]=e=>le.value=e),title:"媒体库",size:"650px"},{default:s((()=>[r(U,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),i("div",H,[r(I,{"image-common":p.value,onOnSuccess:re},null,8,["image-common"]),r(z,{"image-url":m.value,"file-size":512,"max-w-h":1080,onOnSuccess:re},null,8,["image-url"]),r(g,{modelValue:M.value.keyword,"onUpdate:modelValue":f[0]||(f[0]=e=>M.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),r(S,{type:"primary",icon:"search",onClick:re},{default:s((()=>[c(" 查询 ")])),_:1})]),i("div",K,[(l(!0),a(y,null,h(ae.value,((e,n)=>(l(),a("div",{key:n,class:"w-40"},[i("div",N,[(l(),o(ie,{key:n,src:t(A)(e.url),fit:"cover",class:"w-full h-full relative",onClick:l=>oe(e.url)},{error:s((()=>[t(_)(e.url||"")?(l(),o(ue,{key:0,size:32,class:"absolute top-[calc(50%-16px)] left-[calc(50%-16px)]"},{default:s((()=>[r(te)])),_:1})):u("",!0),t(_)(e.url||"")?(l(),a("video",{key:1,class:"w-full h-full object-cover",muted:"",preload:"metadata",onClick:l=>oe(e.url)},[i("source",{src:t(A)(e.url)+"#t=1"},null,8,$),c(" 您的浏览器不支持视频播放 ")],8,Z)):(l(),a("div",q,[r(ue,{size:32},{default:s((()=>[r(t(C))])),_:1})]))])),_:2},1032,["src","onClick"])),i("div",{class:"absolute -right-1 top-1 w-8 h-8 group-hover:inline-block hidden",onClick:l=>(e=>{B.confirm("是否删除该文件","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await T(e)).code&&(k({type:"success",message:"删除成功!"}),re())})).catch((()=>{k({type:"info",message:"已取消删除"})}))})(e)},[r(ue,{size:16},{default:s((()=>[r(ne)])),_:1})],8,J)]),i("div",{class:"overflow-hidden text-nowrap overflow-ellipsis text-center w-full",onClick:l=>(async e=>{B.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:l})=>{e.name=l,0===(await V(e)).code&&(k({type:"success",message:"编辑成功!"}),re())})).catch((()=>{k({type:"info",message:"取消修改"})}))})(e)},w(e.name),9,L)])))),128))]),r(ce,{"current-page":P.value,"page-size":O.value,total:F.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:ee,onSizeChange:Y},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])])}}};export{Q as _};
