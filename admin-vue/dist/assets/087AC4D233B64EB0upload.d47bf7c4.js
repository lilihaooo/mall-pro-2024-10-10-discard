/*! 
 Build based on admin-vue 
 Time : 1721439181000 */
import{_ as a,a as e,Q as t,o,c as i,b as l,d as s,w as n,g as r,t as p,x as u,aq as c,ar as m,j as d,l as B,E as g,au as C}from"./087AC4D233B64EB0index.3a42c3d0.js";/* empty css                                */import{E as v}from"./087AC4D233B64EB0pagination.0e771729.js";/* empty css                              *//* empty css                            */import"./087AC4D233B64EB0select.e68fc9c3.js";import"./087AC4D233B64EB0scrollbar.f28f83ad.js";/* empty css                               */import{E,a as f}from"./087AC4D233B64EB0table-column.d8728fc7.js";/* empty css                                 *//* empty css                                *//* empty css                               */import{_ as j,U as A,g as D,d as w,e as h}from"./087AC4D233B64EB0common.41b28400.js";import{C as y}from"./087AC4D233B64EB0index.df61f6ab.js";import{W as b}from"./087AC4D233B64EB0warningBar.7ffbb10e.js";import{E as x}from"./087AC4D233B64EB0index.83c0fa4e.js";import"./087AC4D233B64EB0isEqual.e78056db.js";import"./087AC4D233B64EB0_Uint8Array.55422573.js";import"./087AC4D233B64EB0index.3ccbca82.js";import"./087AC4D233B64EB0token.9ae252be.js";import"./087AC4D233B64EB0strings.8c6e2eb6.js";import"./087AC4D233B64EB0debounce.c5d6bbb5.js";import"./087AC4D233B64EB0_baseIteratee.5313185f.js";import"./087AC4D233B64EB0index.f44b2100.js";import"./087AC4D233B64EB0castArray.cde6f052.js";import"./087AC4D233B64EB0index.680eed92.js";import"./087AC4D233B64EB0_initCloneObject.f657614f.js";import"./087AC4D233B64EB0upload.c9108627.js";import"./087AC4D233B64EB0progress.335b8c48.js";import"./087AC4D233B64EB0cloneDeep.9f04767c.js";import"./087AC4D233B64EB0_baseClone.00b8bfb0.js";import"./087AC4D233B64EB0image-viewer.20dbe01e.js";import"./087AC4D233B64EB0position.2dcc468e.js";const _=(a,e)=>{var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0,t.width,t.height);var o=a.toDataURL("image/png"),i=document.createElement("a"),l=new MouseEvent("click");i.download=e||"photo",i.href=o,i.dispatchEvent(l)},t.src=a},k={class:"gva-table-box"},z={class:"gva-btn-list gap-3"},O=["onClick"],U={class:"gva-pagination"},S=a(Object.assign({name:"Upload"},{__name:"upload",setup(a){const S=e("/api"),I=e(""),T=e(""),V=e(1),q=e(0),L=e(10),M=e({}),H=e([]),J=a=>{L.value=a,N()},K=a=>{V.value=a,N()},N=async()=>{const a=await D({page:V.value,pageSize:L.value,...M.value});0===a.code&&(H.value=a.data.list,q.value=a.data.total,V.value=a.data.page,L.value=a.data.pageSize)};N();return(a,e)=>{const D=B,P=g,Q=E,R=x,W=f,F=v,G=C;return t((o(),i("div",null,[l("div",k,[s(b,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),l("div",z,[s(j,{"image-common":T.value,onOnSuccess:N},null,8,["image-common"]),s(A,{"image-url":I.value,"file-size":512,"max-w-h":1080,onOnSuccess:N},null,8,["image-url"]),s(D,{modelValue:M.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>M.value.keyword=a),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),s(P,{type:"primary",icon:"search",onClick:N},{default:n((()=>[r("查询")])),_:1})]),s(W,{data:H.value},{default:n((()=>[s(Q,{align:"left",label:"预览",width:"100"},{default:n((a=>[s(y,{"pic-type":"file","pic-src":a.row.url,preview:""},null,8,["pic-src"])])),_:1}),s(Q,{align:"left",label:"日期",prop:"UpdatedAt",width:"180"},{default:n((a=>[l("div",null,p(u(c)(a.row.UpdatedAt)),1)])),_:1}),s(Q,{align:"left",label:"文件名/备注",prop:"name",width:"180"},{default:n((a=>[l("div",{class:"name",onClick:e=>(async a=>{m.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:a.name}).then((async({value:e})=>{a.name=e,0===(await h(a)).code&&(d({type:"success",message:"编辑成功!"}),N())})).catch((()=>{d({type:"info",message:"取消修改"})}))})(a.row)},p(a.row.name),9,O)])),_:1}),s(Q,{align:"left",label:"链接",prop:"url","min-width":"300"}),s(Q,{align:"left",label:"标签",prop:"tag",width:"100"},{default:n((a=>[s(R,{type:"jpg"===a.row.tag?"info":"success","disable-transitions":""},{default:n((()=>[r(p(a.row.tag),1)])),_:2},1032,["type"])])),_:1}),s(Q,{align:"left",label:"操作",width:"160"},{default:n((a=>[s(P,{icon:"download",type:"primary",link:"",onClick:e=>{var t;(t=a.row).url.indexOf("http://")>-1||t.url.indexOf("https://")>-1?_(t.url,t.name):_(S.value+"/"+t.url,t.name)}},{default:n((()=>[r("下载")])),_:2},1032,["onClick"]),s(P,{icon:"delete",type:"primary",link:"",onClick:e=>(async a=>{m.confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await w(a)).code&&(d({type:"success",message:"删除成功!"}),1===H.value.length&&V.value>1&&V.value--,N())})).catch((()=>{d({type:"info",message:"已取消删除"})}))})(a.row)},{default:n((()=>[r("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),l("div",U,[s(F,{"current-page":V.value,"page-size":L.value,"page-sizes":[10,30,50,100],style:{float:"right",padding:"20px"},total:q.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:K,onSizeChange:J},null,8,["current-page","page-size","total"])])])])),[[G,a.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-a3ff3136"]]);export{S as default};
