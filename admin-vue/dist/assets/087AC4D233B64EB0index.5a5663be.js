/*! 
 Build based on admin-vue 
 Time : 1721439181000 */
import{y as e,dK as t,aB as a,dx as l,N as o,P as i,O as n,a as s,B as r,aK as p,o as u,h as d,w as c,b as m,n as f,x as B,S as C,Y as v,ag as y,e as g,g as A,t as b,d as E,E as h,X as x,aN as j,a0 as D,a4 as _,u as k,c as T,aq as w,ar as V,j as S}from"./087AC4D233B64EB0index.3a42c3d0.js";import{E as N}from"./087AC4D233B64EB0dialog.8a425e00.js";import"./087AC4D233B64EB0overlay.b3cb4214.js";/* empty css                               *//* empty css                                *//* empty css                               */import{a as z,E as M}from"./087AC4D233B64EB0form-item.3185fbfe.js";/* empty css                                 */import{E as I}from"./087AC4D233B64EB0pagination.0e771729.js";/* empty css                              *//* empty css                            */import"./087AC4D233B64EB0select.e68fc9c3.js";import"./087AC4D233B64EB0scrollbar.f28f83ad.js";import{E as O,a as U}from"./087AC4D233B64EB0table-column.d8728fc7.js";/* empty css                                */import{f as q,h as $,r as K}from"./087AC4D233B64EB0autoCode.6d928f43.js";import{E as P}from"./087AC4D233B64EB0index.83c0fa4e.js";import{E as G}from"./087AC4D233B64EB0index.680eed92.js";import{u as H,E as R}from"./087AC4D233B64EB0index.3ccbca82.js";import"./087AC4D233B64EB0castArray.cde6f052.js";import"./087AC4D233B64EB0_baseClone.00b8bfb0.js";import"./087AC4D233B64EB0_Uint8Array.55422573.js";import"./087AC4D233B64EB0_initCloneObject.f657614f.js";import"./087AC4D233B64EB0isEqual.e78056db.js";import"./087AC4D233B64EB0token.9ae252be.js";import"./087AC4D233B64EB0strings.8c6e2eb6.js";import"./087AC4D233B64EB0debounce.c5d6bbb5.js";import"./087AC4D233B64EB0_baseIteratee.5313185f.js";import"./087AC4D233B64EB0index.f44b2100.js";const X=e({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:t,default:"primary"},cancelButtonType:{type:String,values:t,default:"text"},icon:{type:a,default:()=>l},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:H.teleported,persistent:H.persistent,width:{type:[String,Number],default:150}}),Y={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},F=o({name:"ElPopconfirm"});const J=_(D(o({...F,props:X,emits:Y,setup(e,{emit:t}){const a=e,{t:l}=i(),o=n("popconfirm"),D=s(),_=()=>{var e,t;null==(t=null==(e=D.value)?void 0:e.onClose)||t.call(e)},k=r((()=>({width:p(a.width)}))),T=e=>{t("confirm",e),_()},w=e=>{t("cancel",e),_()},V=r((()=>a.confirmButtonText||l("el.popconfirm.confirmButtonText"))),S=r((()=>a.cancelButtonText||l("el.popconfirm.cancelButtonText")));return(e,t)=>(u(),d(B(R),j({ref_key:"tooltipRef",ref:D,trigger:"click",effect:"light"},e.$attrs,{"popper-class":"".concat(B(o).namespace.value,"-popover"),"popper-style":B(k),teleported:e.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":e.hideAfter,persistent:e.persistent}),{content:c((()=>[m("div",{class:f(B(o).b())},[m("div",{class:f(B(o).e("main"))},[!e.hideIcon&&e.icon?(u(),d(B(C),{key:0,class:f(B(o).e("icon")),style:v({color:e.iconColor})},{default:c((()=>[(u(),d(y(e.icon)))])),_:1},8,["class","style"])):g("v-if",!0),A(" "+b(e.title),1)],2),m("div",{class:f(B(o).e("action"))},[E(B(h),{size:"small",type:"text"===e.cancelButtonType?"":e.cancelButtonType,text:"text"===e.cancelButtonType,onClick:w},{default:c((()=>[A(b(B(S)),1)])),_:1},8,["type","text"]),E(B(h),{size:"small",type:"text"===e.confirmButtonType?"":e.confirmButtonType,text:"text"===e.confirmButtonType,onClick:T},{default:c((()=>[A(b(B(V)),1)])),_:1},8,["type","text"])],2)],2)])),default:c((()=>[e.$slots.reference?x(e.$slots,"reference",{key:0}):g("v-if",!0)])),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}}),[["__file","popconfirm.vue"]])),L={class:"gva-table-box"},Q={class:"gva-btn-list"},W={class:"gva-pagination"},Z={class:"dialog-footer"},ee=Object.assign({name:"AutoCodeAdmin"},{__name:"index",setup(e){const t=s({id:void 0,deleteApi:!0,deleteMenu:!0,deleteTable:!1}),a=k(),l=s(!1),o=s(""),i=s(1),n=s(0),r=s(10),p=s([]),f=e=>{r.value=e,v()},C=e=>{i.value=e,v()},v=async()=>{const e=await q({page:i.value,pageSize:r.value});0===e.code&&(p.value=e.data.list,n.value=e.data.total,i.value=e.data.page,r.value=e.data.pageSize)};v();const y=()=>{l.value=!1,t.value={id:void 0,deleteApi:!0,deleteMenu:!0,deleteTable:!1}},g=e=>{e&&V.confirm("此操作将删除自动创建的文件和api（会删除表！！！）, 是否继续?","提示",{closeOnClickModal:!1,distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{V.confirm("此操作将删除自动创建的文件和api（会删除表！！！）, 请继续确认！！！","会删除表",{closeOnClickModal:!1,distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((()=>{t.value.deleteTable=!1}))})).catch((()=>{t.value.deleteTable=!1}))},x=async()=>{0===(await K(t.value)).code&&(S.success("回滚成功"),v())},j=e=>{e?a.push({name:"autoCodeEdit",params:{id:e.ID}}):a.push({name:"autoCode"})};return(e,a)=>{const s=h,D=O,_=P,k=U,q=I,K=G,H=z,R=M,X=J,Y=N;return u(),T("div",null,[m("div",L,[m("div",Q,[E(s,{type:"primary",icon:"plus",onClick:a[0]||(a[0]=e=>j(null))},{default:c((()=>[A("新增")])),_:1})]),E(k,{data:p.value},{default:c((()=>[E(D,{type:"selection",width:"55"}),E(D,{align:"left",label:"id",width:"60",prop:"ID"}),E(D,{align:"left",label:"日期",width:"180"},{default:c((e=>[A(b(B(w)(e.row.CreatedAt)),1)])),_:1}),E(D,{align:"left",label:"结构体名","min-width":"150",prop:"structName"}),E(D,{align:"left",label:"结构体描述","min-width":"150",prop:"structCNName"}),E(D,{align:"left",label:"表名称","min-width":"150",prop:"tableName"}),E(D,{align:"left",label:"回滚标记","min-width":"150",prop:"flag"},{default:c((e=>[e.row.flag?(u(),d(_,{key:0,type:"danger",effect:"dark"},{default:c((()=>[A(" 已回滚 ")])),_:1})):(u(),d(_,{key:1,type:"success",effect:"dark"},{default:c((()=>[A(" 未回滚 ")])),_:1}))])),_:1}),E(D,{align:"left",label:"操作","min-width":"240"},{default:c((e=>[m("div",null,[E(s,{type:"primary",link:"",disabled:1===e.row.flag,onClick:a=>{return i=e.row,o.value="回滚："+i.structName,t.value.id=i.ID,void(l.value=!0);var i}},{default:c((()=>[A("回滚")])),_:2},1032,["disabled","onClick"]),E(s,{type:"primary",link:"",onClick:t=>j(e.row)},{default:c((()=>[A("复用")])),_:2},1032,["onClick"]),E(s,{type:"primary",link:"",onClick:t=>(async e=>{V.confirm("此操作将删除本历史, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await $({id:Number(e.ID)})).code&&(S.success("删除成功"),v())}))})(e.row)},{default:c((()=>[A("删除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"]),m("div",W,[E(q,{"current-page":i.value,"page-size":r.value,"page-sizes":[10,30,50,100],total:n.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:C,onSizeChange:f},null,8,["current-page","page-size","total"])])]),E(Y,{title:o.value,modelValue:l.value,"onUpdate:modelValue":a[4]||(a[4]=e=>l.value=e),"before-close":y,width:"600px"},{footer:c((()=>[m("div",Z,[E(s,{onClick:y},{default:c((()=>[A("取 消")])),_:1}),E(X,{title:"此操作将回滚生成文件和勾选项目, 是否继续?",onConfirm:x},{reference:c((()=>[E(s,{type:"primary"},{default:c((()=>[A("确 定")])),_:1})])),_:1})])])),default:c((()=>[E(R,{inline:!0,model:t.value,"label-width":"80px"},{default:c((()=>[E(H,{label:"选项："},{default:c((()=>[E(K,{label:"删除接口",modelValue:t.value.deleteApi,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.deleteApi=e)},null,8,["modelValue"]),E(K,{label:"删除菜单",modelValue:t.value.deleteMenu,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.deleteMenu=e)},null,8,["modelValue"]),E(K,{label:"删除表",modelValue:t.value.deleteTable,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.deleteTable=e),onChange:g},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}});export{ee as default};
